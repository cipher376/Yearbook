{"version":3,"sources":["webpack:///src/app/public/users-search/users-search.page.html","webpack:///src/app/public/users-search/users-search.module.ts","webpack:///src/app/public/users-search/users-search.page.scss","webpack:///src/app/public/users-search/users-search.page.ts"],"names":["routes","path","component","UsersSearchPageModule","imports","forChild","declarations","UsersSearchPage","browserHistory","router","filterPopover","userService","loadingController","previousPage","selectedUsers","users","usersIdentityPhoto","userAlumni","sub$","searchOffset","searchLimit","searchKey","push","previousPageSource$","subscribe","search","destroySubscription","ev","create","cssClass","event","translucent","showBackdrop","popover","present","isAuthenticated","message","duration","loading","onDidDismiss","role","data","console","log","keyTrigger","pageInfo","offset","limit","searchUser","getIdentityPhotos","concat","length","infiniteScrollTarget","complete","target","identityPhoto","getUserProfilePhotoUrl","selector","template"],"mappings":"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","file":"public-users-search-users-search-module-es5.js","sourcesContent":["export default \"<ion-content>\\r\\n  <ion-row class=\\\"top-row-header ion-no-padding\\\" style=\\\"box-shadow: 0px 2px 4px -4px;\\\">\\r\\n    <ion-col size=\\\"12\\\" class=\\\"ion-no-padding\\\">\\r\\n      <ion-item lines=\\\"none\\\" class=\\\"fs-12 poppins-bold ion-no-padding ion-text-nowrap\\\">\\r\\n        <ion-row slot=\\\"end\\\">\\r\\n          <ion-note class=\\\"fs-112 poppins-bold\\\" color=\\\"dark\\\"> Search &amp; Explore </ion-note>&nbsp;&nbsp;\\r\\n        </ion-row>\\r\\n        <ion-row slot=\\\"start\\\" (click)=\\\"presentPopover()\\\">\\r\\n          <ion-note class=\\\"fs-12 poppins-regular\\\" *ngIf=\\\"selectedUsers?.length>0\\\">\\r\\n             @{{ selectedUsers[0]?.firstName }} {{ selectedUsers[0]?.otherName}} {{ selectedUsers[0]?.lastName }}\\r\\n          </ion-note> &nbsp;&nbsp;\\r\\n          <ion-icon color=\\\"dark\\\" class=\\\"fs-14\\\" name=\\\"filter-outline\\\"></ion-icon> &nbsp;\\r\\n          <ion-note class=\\\"fs-12 poppins-regular\\\" *ngIf=\\\"selectedUsers?.length===0\\\"> Filter </ion-note>&nbsp;&nbsp;\\r\\n        </ion-row>\\r\\n      </ion-item>\\r\\n    </ion-col>\\r\\n\\r\\n    <ion-col>\\r\\n      <ion-searchbar animated showCancelButton=\\\"focus\\\" debounce=\\\"500\\\"\\r\\n        autocomplete=\\\"'on'|'name'|'country-name'|'email'|'organization'|'address-line1'|'address-line2'|'street-address'|'sex'|'tel-country-code'|'url'|'tel'\\\"\\r\\n        placeholder=\\\"Search users\\\" (ionChange)=\\\"search()\\\" type=\\\"'search'|'email'|'tel'|'text'|'url'\\\"\\r\\n        inputmode=\\\"'text'|'tel'|'email'|'url'|'search'\\\" [(ngModel)]=\\\"searchKey\\\"></ion-searchbar>\\r\\n    </ion-col>\\r\\n  </ion-row>\\r\\n\\r\\n  <!-- Top correction -->\\r\\n  <ion-row class=\\\"ion-content-top_correction\\\"></ion-row>\\r\\n  <!-- Top correction ends -->\\r\\n\\r\\n  <!-- Main body content -->\\r\\n  <ion-row>\\r\\n    <ion-col size=\\\"12\\\" class=\\\"ion-no-padding\\\" *ngFor=\\\"let user of users; let i=index;\\\">\\r\\n      <app-user-list-item [user]=\\\"user\\\" [profilePhotoUrl]=\\\"getProfilePhotoUrl(usersIdentityPhoto[i])\\\"></app-user-list-item>\\r\\n    </ion-col>\\r\\n  </ion-row>\\r\\n\\r\\n  <!-- Main body content ends -->\\r\\n  <ion-infinite-scroll threshold=\\\"100px\\\" (ionInfinite)=\\\"loadMoreEvents($event)\\\">\\r\\n    <ion-infinite-scroll-content loadingSpinner=\\\"bubbles\\\" loadingText=\\\"Loading users...\\\">\\r\\n    </ion-infinite-scroll-content>\\r\\n  </ion-infinite-scroll>\\r\\n</ion-content>\";","import { WidgetsModule } from 'src/app/widgets/widgets.module';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\n\r\nimport { UsersSearchPage } from './users-search.page';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: UsersSearchPage\r\n  }\r\n];\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes),\r\n    WidgetsModule\r\n  ],\r\n  declarations: [UsersSearchPage]\r\n})\r\nexport class UsersSearchPageModule {}\r\n","export default \".ion-content-top_correction {\\n  margin-top: 110px !important;\\n}\\n\\nion-activated {\\n  background: yellow;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcHVibGljL3VzZXJzLXNlYXJjaC91c2Vycy1zZWFyY2gucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksNEJBQUE7QUFDSjs7QUFDQTtFQUNJLGtCQUFBO0FBRUoiLCJmaWxlIjoic3JjL2FwcC9wdWJsaWMvdXNlcnMtc2VhcmNoL3VzZXJzLXNlYXJjaC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuaW9uLWNvbnRlbnQtdG9wX2NvcnJlY3Rpb24ge1xyXG4gICAgbWFyZ2luLXRvcDogMTEwcHggIWltcG9ydGFudDtcclxufVxyXG5pb24tYWN0aXZhdGVke1xyXG4gICAgYmFja2dyb3VuZDogeWVsbG93O1xyXG59Il19 */\";","import { Component, OnInit, ViewChild, AfterViewInit, OnDestroy } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { IonInfiniteScroll, LoadingController, PopoverController } from '@ionic/angular';\r\nimport { Alumni } from 'src/app/models/alumni';\r\nimport { IdentityPhoto } from 'src/app/models/my-media';\r\nimport { PageInfo } from 'src/app/models/page';\r\nimport { User } from 'src/app/models/user';\r\nimport { SchoolService } from 'src/app/shared/services/model-service/school.service';\r\nimport { UserService } from 'src/app/shared/services/model-service/user.service';\r\nimport { BrowserHistoryService } from 'src/app/shared/services/providers/navigation/browser-history.service';\r\nimport { UtilityService } from 'src/app/shared/services/providers/utility.service';\r\nimport { FeedFilterPopoverComponent } from 'src/app/widgets/feed-filter-popover/feed-filter-popover.component';\r\n\r\n@Component({\r\n  selector: 'app-users-search',\r\n  templateUrl: './users-search.page.html',\r\n  styleUrls: ['./users-search.page.scss'],\r\n})\r\nexport class UsersSearchPage implements OnInit, OnDestroy, AfterViewInit {\r\n  previousPage = '';\r\n  selectedUsers: User[] = [];\r\n  users: User[] = [];\r\n  usersIdentityPhoto: IdentityPhoto[] = [];\r\n\r\n  userAlumni: Alumni[] = [];\r\n\r\n  sub$ = [];\r\n\r\n  searchOffset = 0; // Begin search at zero index;\r\n  searchLimit = 10; // pull 20 users at a time\r\n  searchKey = '';\r\n\r\n  infiniteScrollTarget: any;\r\n  @ViewChild(IonInfiniteScroll) infiniteScroll: IonInfiniteScroll;\r\n\r\n  constructor(\r\n    private browserHistory: BrowserHistoryService,\r\n    private router: Router,\r\n    public filterPopover: PopoverController,\r\n    private userService: UserService,\r\n    private loadingController: LoadingController,\r\n\r\n  ) {\r\n    this.sub$.push(this.browserHistory.previousPageSource$.subscribe(previousPage => {\r\n      this.previousPage = previousPage;\r\n    }));\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.search(false);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    UtilityService.destroySubscription(this.sub$);\r\n  }\r\n\r\n\r\n  async presentPopover(ev: any) {\r\n    const popover = await this.filterPopover.create({\r\n      component: FeedFilterPopoverComponent,\r\n      cssClass: 'filter-feed',\r\n      event: ev,\r\n      translucent: true,\r\n      showBackdrop: false\r\n    });\r\n    return await popover.present();\r\n  }\r\n\r\n  // goBack() {\r\n  //   this.router.navigateByUrl(this.browserHistory.getPreviousUrl());\r\n  // }\r\n\r\n  isAuthenticated() {\r\n    return this.userService.isAuthenticated();\r\n  }\r\n\r\n  async presentLoading() {\r\n    const loading = await this.loadingController.create({\r\n      cssClass: 'my-custom-class',\r\n      message: 'Please wait...',\r\n      duration: 2000\r\n    });\r\n    await loading.present();\r\n\r\n    const { role, data } = await loading.onDidDismiss();\r\n    console.log('Loading dismissed!');\r\n  }\r\n\r\n\r\n  // if search term change, it means key\r\n  // trigger is true\r\n  search(keyTrigger = true) {\r\n\r\n    // if ( this.users.length === 0 ) {\r\n    //   this.presentLoading().then((res: any) => {\r\n    //     this.users.length === 0 ? res.dismiss() : this.toast.toast('Sorry, something went wrong!')\r\n    //   });\r\n    // }\r\n\r\n    console.log('searching');\r\n    // refresh search\r\n    if (keyTrigger) {\r\n      this.searchOffset = 0;\r\n    }\r\n    const pageInfo = {\r\n      offset: this.searchOffset,\r\n      limit: this.searchLimit\r\n    } as PageInfo;\r\n\r\n    this.userService.searchUser(this.searchKey, pageInfo).subscribe(users => {\r\n      if (keyTrigger) {\r\n        console.log(users);\r\n        this.users = users;\r\n        this.usersIdentityPhoto = UtilityService.getIdentityPhotos(users);\r\n      } else {\r\n        this.users = this.users.concat(users);\r\n        this.searchOffset = this.users.length;\r\n        this.infiniteScrollTarget?.complete();\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  loadMoreEvents(event) {\r\n    this.infiniteScrollTarget = event.target;\r\n    this.search(false);\r\n  }\r\n\r\n  getProfilePhotoUrl(identityPhoto: IdentityPhoto) {\r\n    return UserService.getUserProfilePhotoUrl(identityPhoto);\r\n  }\r\n\r\n}\r\n"]}